{% extends "base.html" %}
{% block title %}支付订单{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>订单支付</h2>
    <p>订单号：{{ order.id }}</p>
    <p>总金额：￥{{ "%.2f"|format(order.total_amount) }}</p>
    <button id="pay-btn" class="btn btn-primary">立即支付</button>
</div>

<script>
document.getElementById('pay-btn').addEventListener('click', async () => {
    const resp = await fetch(`/payment/pay/{{ order.id }}`, { method:'POST', headers:{'Content-Type':'application/json'} });
    const data = await resp.json();
    if (!data.success) { alert(data.message); return; }
    alert(data.message);
    window.location.href = data.redirect;  // 支付成功跳订单详情页
});
</script>
{% endblock %}
